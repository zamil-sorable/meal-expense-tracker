<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Meal Expense Tracker</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
  <div class="container">
    <header>
      <h1>Meal Expense Tracker</h1>
      <p class="subtitle">Track your daily meals (up to RM50/day, Mon-Fri)</p>
    </header>

    <main>
      <!-- Add Expense Form -->
      <section class="form-section">
        <h2>Add New Meal</h2>
        <form id="expenseForm">
          <div class="form-group">
            <label for="date">Date:</label>
            <input type="date" id="date" name="date" required>
          </div>

          <div class="form-group">
            <label for="day">Day:</label>
            <div class="day-display">
              <input type="hidden" id="day" name="day" value="">
              <span class="day-badge" id="dayBadge">Wednesday</span>
            </div>
          </div>

          <div class="form-group">
            <label for="amount">Amount (RM):</label>
            <input type="number" id="amount" name="amount" step="0.01" min="0.01" required>
          </div>

          <div class="form-group">
            <label for="place">Place/Restaurant:</label>
            <input type="text" id="place" name="place" required>
          </div>

          <div class="form-group">
            <label for="receipt">Receipt Photo:</label>
            <div class="file-upload-zone" id="fileUploadZone">
              <input type="file" id="receipt" name="receipt" accept="image/*" required hidden>
              <div class="file-upload-content" id="fileUploadContent">
                <i data-lucide="upload-cloud" class="upload-icon"></i>
                <p class="upload-text">Drag & drop your receipt here</p>
                <p class="upload-subtext">or click to browse</p>
              </div>
              <div class="file-preview" id="filePreview" style="display: none;">
                <img id="previewImage" src="" alt="Preview">
                <button type="button" class="remove-file-btn" id="removeFileBtn">
                  <i data-lucide="x"></i>
                </button>
              </div>
            </div>
          </div>

          <button type="submit" class="btn btn-primary">
            <i data-lucide="plus-circle"></i>
            <span>Add Expense</span>
          </button>
        </form>
      </section>

      <!-- Summary Section -->
      <section class="summary-section">
        <h2>Summary</h2>

        <!-- Daily Limit Progress -->
        <div class="daily-limit-card">
          <div class="daily-limit-header">
            <div>
              <h3>Today's Usage</h3>
              <p class="daily-limit-text"><span id="todayAmount">RM 0.00</span> of RM 50.00</p>
            </div>
            <div class="daily-limit-icon">
              <i data-lucide="wallet"></i>
            </div>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
          </div>
          <p class="daily-limit-remaining" id="remainingText">RM 50.00 remaining</p>
        </div>

        <div class="summary-cards">
          <div class="summary-card">
            <div class="card-icon">
              <i data-lucide="calendar"></i>
            </div>
            <h3>This Week</h3>
            <p class="amount" id="weekTotal">RM 0.00</p>
          </div>
          <div class="summary-card">
            <div class="card-icon">
              <i data-lucide="calendar-range"></i>
            </div>
            <h3>This Month</h3>
            <p class="amount" id="monthTotal">RM 0.00</p>
          </div>
          <div class="summary-card">
            <div class="card-icon">
              <i data-lucide="trending-up"></i>
            </div>
            <h3>Total</h3>
            <p class="amount" id="overallTotal">RM 0.00</p>
          </div>
        </div>
      </section>

      <!-- Public Holidays Management -->
      <section class="form-section">
        <h2>Manage Public Holidays</h2>
        <form id="holidayForm">
          <div class="form-row">
            <div class="form-group">
              <label for="holidayDate">Date:</label>
              <input type="date" id="holidayDate" name="date" required>
            </div>

            <div class="form-group">
              <label for="holidayName">Holiday Name:</label>
              <input type="text" id="holidayName" name="name" placeholder="e.g., Malaysia Day" required>
            </div>

            <button type="submit" class="btn btn-primary">
              <i data-lucide="plus-circle"></i>
              <span>Add Holiday</span>
            </button>
          </div>
        </form>

        <!-- Holidays Table -->
        <div class="table-wrapper" style="margin-top: 20px;">
          <table id="holidaysTable">
            <thead>
              <tr>
                <th>Date</th>
                <th>Day</th>
                <th>Holiday Name</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="holidaysBody">
              <tr>
                <td colspan="4" class="no-data">No public holidays added yet</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Expenses Table -->
      <section class="table-section">
        <div class="table-header">
          <h2>All Expenses</h2>
          <button id="exportBtn" class="btn btn-success">
            <i data-lucide="download"></i>
            <span>Export to ZIP</span>
          </button>
        </div>

        <div class="table-wrapper">
          <table id="expensesTable">
            <thead>
              <tr>
                <th>Date</th>
                <th>Day</th>
                <th>Amount (RM)</th>
                <th>Place</th>
                <th>Receipt</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="expensesBody">
              <tr>
                <td colspan="6" class="no-data">No expenses added yet</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    </main>
  </div>

  <!-- Receipt Modal -->
  <div id="receiptModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <img id="receiptImage" src="" alt="Receipt">
    </div>
  </div>

  <!-- Toast Container -->
  <div id="toastContainer" class="toast-container"></div>

  <script src="app.js"></script>
  <script>
    // Initialize Lucide icons
    lucide.createIcons();
  </script>
</body>
</html>